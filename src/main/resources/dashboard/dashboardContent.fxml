<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.canvas.Canvas?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<AnchorPane xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="gr.uoi.dit.master2025.gkouvas.dppclient.controller.DashboardContentController">

    <children>

        <VBox spacing="25" styleClass="dashboard-root" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">

            <!-- ========================== KPI ROW ============================ -->
            <HBox alignment="CENTER" spacing="20" styleClass="kpi-row">

                <VBox fx:id="onlineDevicesBox" alignment="CENTER" styleClass="kpi-card">
               <Label layoutX="10.0" layoutY="10.0" styleClass="kpi-title" text="ðŸŸ¢  Î£Ï…ÏƒÎºÎµÏ…Î­Ï‚" />
                    <Label styleClass="kpi-title" text="Online" />
                    <Label fx:id="onlineLabel" styleClass="kpi-value" text="0" />
                </VBox>

                <VBox fx:id="offlineDevicesBox" alignment="CENTER" styleClass="kpi-card">
               <Label layoutX="10.0" layoutY="19.0" styleClass="kpi-title" text="ðŸ”´  Î£Ï…ÏƒÎºÎµÏ…Î­Ï‚" />
                    <Label styleClass="kpi-title" text="Offline" />
                    <Label fx:id="offlineDevicesLabel" styleClass="kpi-value" text="0" />
                </VBox>

                <VBox fx:id="uptimeBox" alignment="CENTER" styleClass="kpi-card">
               <Label layoutX="10.0" layoutY="19.0" styleClass="kpi-title" text="â±ï¸  Î£Ï…ÏƒÎºÎµÏ…Î­Ï‚" />
                    <Label alignment="CENTER" styleClass="kpi-title" text="Uptime" />
                    <Label fx:id="uptimeLabel" styleClass="kpi-value" text="0%" />
                </VBox>

                <VBox fx:id="dueMaintBox" alignment="CENTER" styleClass="kpi-card">
               <Label layoutX="10.0" layoutY="19.0" styleClass="kpi-title" text="ðŸ“… Î£Ï…Î½Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚" />
                    <Label alignment="CENTER" styleClass="kpi-title" text="Î£ÏÎ½Î¿Î»Î¿" />
                    <Label fx:id="totalMaintLabel" styleClass="kpi-value" text="0" />
                </VBox>
            <VBox fx:id="completeMaintBox" alignment="CENTER" layoutX="776.0" layoutY="10.0" styleClass="kpi-card">
               <children>
                  <Label alignment="CENTER" layoutX="10.0" layoutY="19.0" styleClass="kpi-title" text="ðŸ“… Î£Ï…Î½Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚" wrapText="true" />
                  <Label alignment="CENTER" styleClass="kpi-title" text="ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½ÎµÏ‚" wrapText="true" />
                  <Label fx:id="completedLabel" styleClass="kpi-value" text="0" />
               </children>
            </VBox>
            <VBox fx:id="pendingMaintBox" alignment="CENTER" layoutX="817.0" layoutY="10.0" styleClass="kpi-card">
               <children>
                  <Label layoutX="10.0" layoutY="19.0" styleClass="kpi-title" text="ðŸ“… Î£Ï…Î½Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚" />
                  <Label styleClass="kpi-title" text="Î•Î½ Î±Î½Î±Î¼Î¿Î½Î®" />
                  <Label fx:id="pendingLabel" styleClass="kpi-value" text="0" />
               </children>
            </VBox>
            <VBox fx:id="cancellMaintBox" alignment="CENTER" layoutX="907.0" layoutY="10.0" styleClass="kpi-card">
               <children>
                  <Label layoutX="10.0" layoutY="19.0" styleClass="kpi-title" text="ðŸ“… Î£Ï…Î½Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚" />
                  <Label styleClass="kpi-title" text="Î‘ÎºÏ…ÏÏ‰Î¼Î­Î½ÎµÏ‚" />
                  <Label fx:id="cancelledLabel" layoutX="48.0" layoutY="27.0" styleClass="kpi-value" text="0" />
               </children>
            </VBox>
            <VBox fx:id="overdueBox" alignment="CENTER" layoutX="464.0" layoutY="10.0" styleClass="kpi-card">
               <children>
                  <Label styleClass="kpi-title" text="ðŸ“… Î£Ï…Î½Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚" />
                  <Label styleClass="kpi-title" text="â±ï¸ Î•ÎºÏ€ÏÏŒÎ¸ÎµÏƒÎ¼ÎµÏ‚" />
                  <Label fx:id="overdueLabel" styleClass="kpi-value" text="0%" />
               </children>
            </VBox>

                <VBox fx:id="riskBox" alignment="CENTER" styleClass="kpi-card">
               <Label layoutX="10.0" layoutY="19.0" styleClass="kpi-title" text="âš ï¸ Î£ÏÏƒÏ„Î·Î¼Î±" />
                    <Label alignment="CENTER" styleClass="kpi-title" text="Risk Level" />
                    <Label fx:id="riskLabel" styleClass="kpi-value" text="0%" />
                </VBox>

            </HBox>



            <!-- ====================== GRID AREA 2 Ã— 2 ======================= -->
            <GridPane hgap="25" vgap="25">
                <columnConstraints>
                    <ColumnConstraints maxWidth="800.0" percentWidth="50" />
                    <ColumnConstraints maxWidth="800.0" percentWidth="50" />
                </columnConstraints>
                <rowConstraints>
                    <RowConstraints percentHeight="25.0" />
                    <RowConstraints percentHeight="25.0" />
               <RowConstraints percentHeight="25.0" />
                </rowConstraints>

                <!-- === Cell 0,0: Alerts Bar Chart === -->
                <VBox spacing="10" GridPane.columnIndex="0" GridPane.rowIndex="0">
                    <Label alignment="CENTER" maxWidth="1.7976931348623157E308" styleClass="chart-title" text="Î•Î¹Î´Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ Î±Î½Î¬ ÏƒÏ…ÏƒÎºÎµÏ…Î®" />
                    <BarChart fx:id="alertsChart" legendVisible="false">
                        <xAxis>
                            <CategoryAxis fx:id="alertsXAxis" label="Î£Ï…ÏƒÎºÎµÏ…Î®" />
                        </xAxis>
                        <yAxis>
                            <NumberAxis fx:id="alertsYAxis" label="Î£ÏÎ½Î¿Î»Î¿" />
                        </yAxis>
                    </BarChart>
                </VBox>

                <!-- === Cell 0,1: Maintenance Forecast LineChart === -->
                <VBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="0">
                    <Label alignment="CENTER" maxWidth="1.7976931348623157E308" styleClass="chart-title" text="Î£Ï…Î½Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚ Ï€Î±ÏÎµÎ»Î¸ÏŒÎ½Ï„Î¿Ï‚ ÎºÎ±Î¹ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼Î¿Ï (Â±30 Î·Î¼Î­ÏÎµÏ‚)" />

                    <BarChart fx:id="maintenanceBarChart" animated="false">
                        <xAxis>
                            <CategoryAxis fx:id="maintenanceXAxis" label="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±" />
                        </xAxis>
                        <yAxis>
                            <NumberAxis label="Î Î»Î®Î¸Î¿Ï‚ ÎµÏÎ³Î±ÏƒÎ¹ÏŽÎ½" />
                        </yAxis>
                    </BarChart>


                </VBox>

                <!-- === Cell 1,0: Failures Heatmap === -->
                <VBox spacing="10" GridPane.columnIndex="0" GridPane.rowIndex="1">
                    <Label alignment="CENTER" maxWidth="1.7976931348623157E308" styleClass="chart-title" text="Heatmap Î’Î»Î±Î²ÏŽÎ½ (ÎÏÎ± Ã— Î—Î¼Î­ÏÎ±)" />
                    <VBox spacing="10">


                            <Pane fx:id="heatmapOverlayPane" pickOnBounds="false" VBox.vgrow="NEVER">
                            <Canvas fx:id="heatmapCanvas" height="300" width="800" />
                            </Pane>



                    </VBox>

                </VBox>

                <!-- === Cell 1,1: Risk Gauge === -->
                <VBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="1">
                    <Label alignment="CENTER" maxWidth="1.7976931348623157E308" styleClass="chart-title" text="Risk Gauge" />
                    <StackPane fx:id="riskGaugePane" prefHeight="300" />
                </VBox>

                <VBox fx:id="activeIssuesCard" spacing="10" styleClass="card" GridPane.columnIndex="0" GridPane.rowIndex="2" xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml">

                    <padding>
                        <Insets bottom="16" left="16" right="16" top="16" />
                    </padding>

                    <!-- Title -->
                    <Label alignment="CENTER" maxWidth="1.7976931348623157E308" styleClass="card-title" text="Î•Î½ÎµÏÎ³Î¬ Î˜Î­Î¼Î±Ï„Î± (Active Issues)">
                  <font>
                     <Font size="14.0" />
                  </font></Label>

                    <!-- Row 1 -->
                    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="metric-row">
                        <Label styleClass="metric-icon" text="âš " />
                        <Label styleClass="metric-label" text="Î•ÎºÎºÏÎµÎ¼ÎµÎ¯Ï‚ ÎµÎ¹Î´Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚:" />
                        <Region prefHeight="17.0" prefWidth="503.0" HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblPendingAlerts" styleClass="metric-value" text="0" />
                    </HBox>

                    <!-- Row 2 -->
                    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="metric-row">
                        <Label styleClass="metric-icon" text="ðŸ› " />
                        <Label styleClass="metric-label" text="Î£Ï…Î½Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚ ÏƒÎµ ÎµÎ¾Î­Î»Î¹Î¾Î·:" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblMaintenanceInProgress" styleClass="metric-value" text="0" />
                    </HBox>

                    <!-- Row 3 -->
                    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="metric-row">
                        <Label styleClass="metric-icon" text="â±" />
                        <Label styleClass="metric-label" text="Îœ.Î§. Î±Ï€Î¿ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚ (MTTR):" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblMttr" styleClass="metric-value" text="â€”" />
                    </HBox>

                    <!-- Row 4 -->
                    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="metric-row">
                        <Label styleClass="metric-icon" text="ðŸ“¡" />
                        <Label styleClass="metric-label" text="Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ IoT ÏƒÏ…Î¼Î²Î¬Î½:" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblLastIotEventTime" styleClass="metric-value" text="â€”" />
                    </HBox>
               <HBox>
                  <children>
      
                          <!-- Optional second line for IoT event (device + channel) -->
                          <Label fx:id="lblLastIotEventDetails" styleClass="muted-text" text="â€”" wrapText="true">
                        <graphic>
                           <Label prefHeight="17.0" prefWidth="367.0" styleClass="muted-text" text="Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î£Ï…Î¼Î²Î¬Î½Ï„Î¿Ï‚" wrapText="true" />
                        </graphic>
                     </Label>
                  </children>
               </HBox>
               <HBox>
                  <children>
                     <Label fx:id="escalatedLabel1" prefHeight="17.0" prefWidth="371.0" styleClass="muted-text" text="Î£Ï…Î¼Î²Î¬Î½Ï„Î± Ï€Î¿Ï… ÎµÏ€Î¹Î»Î®Î¸Î·ÎºÎ±Î½ Î±Ï€Î¿ Ï„Î¿ Î£ÏÏƒÏ„Î·Î¼Î±" wrapText="true" />
                     <Label fx:id="autoClosedLabel" prefHeight="17.0" prefWidth="361.0" styleClass="muted-text" text="â€”" wrapText="true" />
                  </children>
               </HBox>
               <HBox>
                  <children>
                     <Label fx:id="escalatedLabel2" layoutX="10.0" layoutY="10.0" prefHeight="17.0" prefWidth="369.0" styleClass="muted-text" text="ÎšÎ±Î¸Ï…ÏƒÏ„ÎµÏÎ·Î¼Î­Î½ÎµÏ‚" wrapText="true" />
                     <Label fx:id="escalatedLabel" styleClass="muted-text" text="â€”" wrapText="true" />
                  </children>
               </HBox>
                </VBox>

                <VBox fx:id="riskDriversBox" spacing="8" styleClass="card-mini" GridPane.columnIndex="1" GridPane.rowIndex="2">

                    <padding>
                        <Insets bottom="12" left="12" right="12" top="12" />
                    </padding>

                    <Label alignment="CENTER" maxWidth="1.7976931348623157E308" styleClass="card-subtitle" text="Î Î±ÏÎ¬Î³Î¿Î½Ï„ÎµÏ‚ ÎšÎ¹Î½Î´ÏÎ½Î¿Ï… ">
                  <font>
                     <Font size="14.0" />
                  </font></Label>

                    <ListView fx:id="riskDriversList" prefHeight="120" styleClass="drivers-list" />
                </VBox>





            </GridPane>

        </VBox>

    </children>

</AnchorPane>
